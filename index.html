<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitLife Pro - Tu Coach Personal Inteligente</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(20px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        @keyframes slideIn {
            from { 
                opacity: 0; 
                transform: translateX(-30px); 
            }
            to { 
                opacity: 1; 
                transform: translateX(0); 
            }
        }
        
        @keyframes scaleIn {
            from { 
                opacity: 0; 
                transform: scale(0.9); 
            }
            to { 
                opacity: 1; 
                transform: scale(1); 
            }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        
        .animate-slide-in {
            animation: slideIn 0.5s ease-out forwards;
        }
        
        .animate-scale-in {
            animation: scaleIn 0.4s ease-out forwards;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .hover-lift:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }
        
        .btn-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        
        .btn-gradient:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
        
        .screen {
            display: none;
        }
        
        .screen.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }
        
        .stat-card-gradient-1 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .stat-card-gradient-2 {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .stat-card-gradient-3 {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .stat-card-gradient-4 {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #764ba2;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .tab-active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <!-- Main Container -->
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <header class="glass-effect rounded-2xl p-8 mb-8 text-center animate-fade-in">
            <div class="flex items-center justify-center mb-4">
                <div class="bg-gradient-to-r from-purple-600 to-indigo-600 p-4 rounded-2xl shadow-lg">
                    <i class="fas fa-dumbbell text-4xl text-white"></i>
                </div>
            </div>
            <h1 class="text-5xl font-bold gradient-text mb-3">FitLife Pro</h1>
            <p class="text-gray-600 text-lg font-medium">Tu Coach Personal Inteligente</p>
            <div class="mt-4 inline-flex items-center bg-gradient-to-r from-purple-100 to-indigo-100 px-6 py-2 rounded-full">
                <i class="fas fa-chart-line text-purple-600 mr-2"></i>
                <span class="text-sm font-semibold text-gray-700">Sistema de Seguimiento Avanzado</span>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="glass-effect rounded-2xl p-2 mb-8 animate-slide-in">
            <div class="grid grid-cols-2 md:grid-cols-6 gap-2">
                <button onclick="showScreen('inicio')" class="nav-btn tab-active px-6 py-4 rounded-xl font-semibold transition-all duration-300 flex items-center justify-center space-x-2">
                    <i class="fas fa-home"></i>
                    <span class="hidden md:inline">Inicio</span>
                </button>
                <button onclick="showScreen('rutinas')" class="nav-btn px-6 py-4 rounded-xl font-semibold transition-all duration-300 hover:bg-purple-50 flex items-center justify-center space-x-2">
                    <i class="fas fa-running"></i>
                    <span class="hidden md:inline">Rutinas</span>
                </button>
                <button onclick="showScreen('progreso')" class="nav-btn px-6 py-4 rounded-xl font-semibold transition-all duration-300 hover:bg-purple-50 flex items-center justify-center space-x-2">
                    <i class="fas fa-chart-bar"></i>
                    <span class="hidden md:inline">Progreso</span>
                </button>
                <button onclick="showScreen('diario')" class="nav-btn px-6 py-4 rounded-xl font-semibold transition-all duration-300 hover:bg-purple-50 flex items-center justify-center space-x-2">
                    <i class="fas fa-book"></i>
                    <span class="hidden md:inline">Diario</span>
                </button>
                <button onclick="showScreen('consejos')" class="nav-btn px-6 py-4 rounded-xl font-semibold transition-all duration-300 hover:bg-purple-50 flex items-center justify-center space-x-2">
                    <i class="fas fa-lightbulb"></i>
                    <span class="hidden md:inline">Consejos</span>
                </button>
                <button onclick="showScreen('resumen')" class="nav-btn px-6 py-4 rounded-xl font-semibold transition-all duration-300 hover:bg-purple-50 flex items-center justify-center space-x-2">
                    <i class="fas fa-trophy"></i>
                    <span class="hidden md:inline">Resumen</span>
                </button>
            </div>
        </nav>

        <!-- Content Area -->
        <div class="animate-scale-in">
            <!-- PANTALLA INICIO -->
            <div id="inicio" class="screen active">
                <div class="glass-effect rounded-2xl p-8 mb-6">
                    <div class="flex items-center mb-6">
                        <div class="bg-gradient-to-r from-purple-600 to-indigo-600 p-3 rounded-xl">
                            <i class="fas fa-user-circle text-2xl text-white"></i>
                        </div>
                        <div class="ml-4">
                            <h2 class="text-3xl font-bold text-gray-800">Perfil Personal</h2>
                            <p class="text-gray-600">Configura tu informaci√≥n para comenzar</p>
                        </div>
                    </div>

                    <!-- Informaci√≥n B√°sica -->
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-id-card text-purple-600 mr-3"></i>
                            Informaci√≥n B√°sica
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-user text-purple-600 mr-2"></i>Nombre Completo
                                </label>
                                <input type="text" id="nombre" placeholder="Ingresa tu nombre" 
                                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-calendar text-purple-600 mr-2"></i>Edad
                                </label>
                                <input type="number" id="edad" placeholder="A√±os" min="10" max="100"
                                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                            </div>
                        </div>
                    </div>

                    <!-- Datos F√≠sicos -->
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-heartbeat text-pink-600 mr-3"></i>
                            Datos F√≠sicos
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-venus-mars text-purple-600 mr-2"></i>Sexo
                                </label>
                                <select id="sexo" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                                    <option value="">Seleccionar</option>
                                    <option value="masculino">Masculino</option>
                                    <option value="femenino">Femenino</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-weight text-purple-600 mr-2"></i>Peso (kg)
                                </label>
                                <input type="number" id="peso" placeholder="Ej: 70.5" step="0.1"
                                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-ruler-vertical text-purple-600 mr-2"></i>Altura (cm)
                                </label>
                                <input type="number" id="altura" placeholder="Ej: 170"
                                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                            </div>
                        </div>
                    </div>

                    <!-- Actividad y Objetivo -->
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-bullseye text-indigo-600 mr-3"></i>
                            Actividad y Objetivos
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-running text-purple-600 mr-2"></i>Nivel de Actividad
                                </label>
                                <select id="nivelActividad" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                                    <option value="">Seleccionar</option>
                                    <option value="sedentario">ü™ë Sedentario (poco ejercicio)</option>
                                    <option value="moderado">üö∂ Moderado (3-5 d√≠as/semana)</option>
                                    <option value="activo">üèÉ Muy Activo (6-7 d√≠as/semana)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-flag-checkered text-purple-600 mr-2"></i>Objetivo Principal
                                </label>
                                <select id="objetivo" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                                    <option value="">Seleccionar</option>
                                    <option value="perder">‚öñÔ∏è P√©rdida de peso</option>
                                    <option value="ganar">üí™ Ganancia muscular</option>
                                    <option value="resistencia">üèÉ Aumentar resistencia</option>
                                    <option value="flexibilidad">üßò Mejorar flexibilidad</option>
                                    <option value="mantener">‚ú® Mantener forma f√≠sica</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <button onclick="guardarDatos()" 
                        class="btn-gradient w-full md:w-auto px-8 py-4 rounded-xl text-white font-bold text-lg shadow-lg flex items-center justify-center space-x-2">
                        <i class="fas fa-save"></i>
                        <span>Guardar y Continuar</span>
                    </button>
                </div>

                <!-- IMC Result -->
                <div id="imcResult" class="glass-effect rounded-2xl p-8 hidden">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                        <i class="fas fa-calculator text-purple-600 mr-3"></i>
                        Tu √çndice de Masa Corporal
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div class="stat-card-gradient-1 rounded-xl p-8 text-white text-center hover-lift">
                            <div class="text-sm font-semibold mb-3 opacity-90">IMC Calculado</div>
                            <div id="imcValue" class="text-5xl font-bold mb-2">--</div>
                            <i class="fas fa-chart-pie text-3xl opacity-75"></i>
                        </div>
                        <div class="stat-card-gradient-2 rounded-xl p-8 text-white text-center hover-lift">
                            <div class="text-sm font-semibold mb-3 opacity-90">Categor√≠a</div>
                            <div id="imcCategory" class="text-3xl font-bold mb-2">--</div>
                            <i class="fas fa-award text-3xl opacity-75"></i>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-6">
                        <p id="imcInterpretation" class="text-gray-700 text-center leading-relaxed"></p>
                    </div>
                </div>
            </div>

            <!-- PANTALLA RUTINAS -->
            <div id="rutinas" class="screen">
                <div class="glass-effect rounded-2xl p-8 mb-6">
                    <div class="flex items-center mb-6">
                        <div class="bg-gradient-to-r from-pink-600 to-orange-600 p-3 rounded-xl">
                            <i class="fas fa-dumbbell text-2xl text-white"></i>
                        </div>
                        <div class="ml-4">
                            <h2 class="text-3xl font-bold text-gray-800">Rutinas Personalizadas</h2>
                            <p class="text-gray-600">Generador inteligente de ejercicios</p>
                        </div>
                    </div>

                    <!-- Configuraci√≥n -->
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-sliders-h text-purple-600 mr-3"></i>
                            Configurar Rutina
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-calendar-check text-purple-600 mr-2"></i>D√≠as por semana
                                </label>
                                <input type="number" id="diasSemana" min="1" max="7" value="3"
                                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-clock text-purple-600 mr-2"></i>Duraci√≥n (minutos)
                                </label>
                                <input type="number" id="duracionSesion" min="15" max="180" value="45"
                                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-layer-group text-purple-600 mr-2"></i>Dificultad
                                </label>
                                <select id="dificultadRutina" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                                    <option value="facil">üòä F√°cil</option>
                                    <option value="medio" selected>üí™ Medio</option>
                                    <option value="dificil">üî• Dif√≠cil</option>
                                </select>
                            </div>
                        </div>
                        <button onclick="generarRutina()" 
                            class="btn-gradient mt-6 px-8 py-4 rounded-xl text-white font-bold text-lg shadow-lg flex items-center space-x-2">
                            <i class="fas fa-magic"></i>
                            <span>Generar Rutina Personalizada</span>
                        </button>
                    </div>
                </div>

                <!-- Rutina Generada -->
                <div id="rutinaGenerada" class="hidden">
                    <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-6 mb-6 border-l-4 border-green-500">
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-3xl text-green-600 mr-4"></i>
                            <div>
                                <h4 class="font-bold text-gray-800 text-lg">¬°Rutina generada exitosamente!</h4>
                                <p class="text-gray-600">Estos ejercicios est√°n personalizados seg√∫n tu objetivo</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glass-effect rounded-2xl p-8">
                        <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-list-check text-purple-600 mr-3"></i>
                            Tu Plan de Ejercicios
                        </h3>
                        <div id="ejerciciosRecomendados" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
                    </div>
                </div>
            </div>

            <!-- PANTALLA PROGRESO -->
            <div id="progreso" class="screen">
                <div class="glass-effect rounded-2xl p-8 mb-6">
                    <div class="flex items-center mb-6">
                        <div class="bg-gradient-to-r from-blue-600 to-cyan-600 p-3 rounded-xl">
                            <i class="fas fa-chart-line text-2xl text-white"></i>
                        </div>
                        <div class="ml-4">
                            <h2 class="text-3xl font-bold text-gray-800">An√°lisis de Progreso</h2>
                            <p class="text-gray-600">Monitoreo avanzado de tu rendimiento</p>
                        </div>
                    </div>

                    <!-- Stats Grid -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                        <div class="stat-card-gradient-1 rounded-xl p-6 text-white text-center hover-lift">
                            <i class="fas fa-dumbbell text-2xl mb-2 opacity-75"></i>
                            <div class="text-xs font-semibold mb-2 opacity-90">Entrenamientos</div>
                            <div id="totalEntrenamientos" class="text-4xl font-bold">0</div>
                        </div>
                        <div class="stat-card-gradient-2 rounded-xl p-6 text-white text-center hover-lift">
                            <i class="fas fa-fire text-2xl mb-2 opacity-75"></i>
                            <div class="text-xs font-semibold mb-2 opacity-90">Calor√≠as</div>
                            <div id="totalCalorias" class="text-4xl font-bold">0</div>
                        </div>
                        <div class="stat-card-gradient-3 rounded-xl p-6 text-white text-center hover-lift">
                            <i class="fas fa-clock text-2xl mb-2 opacity-75"></i>
                            <div class="text-xs font-semibold mb-2 opacity-90">Minutos</div>
                            <div id="totalTiempo" class="text-4xl font-bold">0</div>
                        </div>
                        <div class="stat-card-gradient-4 rounded-xl p-6 text-white text-center hover-lift">
                            <i class="fas fa-bolt text-2xl mb-2 opacity-75"></i>
                            <div class="text-xs font-semibold mb-2 opacity-90">Racha</div>
                            <div id="rachaActual" class="text-4xl font-bold">0</div>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white rounded-xl p-6 shadow-sm">
                            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-weight text-purple-600 mr-3"></i>
                                Evoluci√≥n del Peso
                            </h3>
                            <div class="h-64">
                                <canvas id="pesoChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl p-6 shadow-sm">
                            <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                                <i class="fas fa-fire-alt text-orange-600 mr-3"></i>
                                Calor√≠as por Semana
                            </h3>
                            <div class="h-64">
                                <canvas id="caloriasChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl p-6 shadow-sm mt-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-chart-pie text-indigo-600 mr-3"></i>
                            Distribuci√≥n de Ejercicios
                        </h3>
                        <div class="h-64">
                            <canvas id="ejerciciosChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PANTALLA DIARIO -->
            <div id="diario" class="screen">
                <div class="glass-effect rounded-2xl p-8 mb-6">
                    <div class="flex items-center mb-6">
                        <div class="bg-gradient-to-r from-green-600 to-teal-600 p-3 rounded-xl">
                            <i class="fas fa-book-open text-2xl text-white"></i>
                        </div>
                        <div class="ml-4">
                            <h2 class="text-3xl font-bold text-gray-800">Diario de Entrenamiento</h2>
                            <p class="text-gray-600">Registra y analiza tus sesiones</p>
                        </div>
                    </div>

                    <!-- Registro -->
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-plus-circle text-green-600 mr-3"></i>
                            Registrar Nuevo Entrenamiento
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-4">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-running text-purple-600 mr-2"></i>Tipo de Ejercicio
                                </label>
                                <select id="tipoEjercicio" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                                    <option value="cardio">üèÉ Cardio</option>
                                    <option value="fuerza">üí™ Fuerza</option>
                                    <option value="flexibilidad">üßò Flexibilidad</option>
                                    <option value="hiit">üî• HIIT</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-stopwatch text-purple-600 mr-2"></i>Duraci√≥n (minutos)
                                </label>
                                <input type="number" id="duracionEjercicio" min="5" value="30"
                                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                            </div>
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">
                                    <i class="fas fa-tachometer-alt text-purple-600 mr-2"></i>Intensidad
                                </label>
                                <select id="intensidad" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                                    <option value="baja">üòä Baja</option>
                                    <option value="media">üí™ Media</option>
                                    <option value="alta">üî• Alta</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-4">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                <i class="fas fa-comment text-purple-600 mr-2"></i>¬øC√≥mo te sentiste?
                            </label>
                            <input type="text" id="notasEjercicio" placeholder="Ej: Me sent√≠ con mucha energ√≠a"
                                class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-purple-500 transition-all duration-300">
                        </div>
                        <button onclick="registrarEntrenamiento()" 
                            class="btn-gradient px-8 py-4 rounded-xl text-white font-bold text-lg shadow-lg flex items-center space-x-2">
                            <i class="fas fa-check"></i>
                            <span>Registrar Entrenamiento</span>
                        </button>
                    </div>

                    <!-- Historial -->
                    <div class="bg-white rounded-xl p-6 shadow-sm">
                        <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                            <i class="fas fa-history text-indigo-600 mr-3"></i>
                            Historial de Entrenamientos
                        </h3>
                        <div id="historialEntrenamientos" class="space-y-4 max-h-96 overflow-y-auto custom-scrollbar"></div>
                    </div>
                </div>
            </div>

            <!-- PANTALLA CONSEJOS -->
            <div id="consejos" class="screen">
                <div class="glass-effect rounded-2xl p-8 mb-6">
                    <div class="flex items-center mb-6">
                        <div class="bg-gradient-to-r from-yellow-600 to-orange-600 p-3 rounded-xl">
                            <i class="fas fa-lightbulb text-2xl text-white"></i>
                        </div>
                        <div class="ml-4">
                            <h2 class="text-3xl font-bold text-gray-800">Consejos de Salud</h2>
                            <p class="text-gray-600">Gu√≠as nutricionales y bienestar</p>
                        </div>
                    </div>

                    <!-- Tips Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                        <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl p-6 text-white hover-lift">
                            <i class="fas fa-water text-4xl mb-4 opacity-75"></i>
                            <h4 class="text-xl font-bold mb-3">Hidrataci√≥n</h4>
                            <p class="text-sm leading-relaxed opacity-90">Bebe 2-3 litros de agua al d√≠a. Es esencial para todas las funciones corporales.</p>
                        </div>
                        <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl p-6 text-white hover-lift">
                            <i class="fas fa-apple-alt text-4xl mb-4 opacity-75"></i>
                            <h4 class="text-xl font-bold mb-3">Alimentaci√≥n</h4>
                            <p class="text-sm leading-relaxed opacity-90">Come 5 porciones de frutas y verduras diarias para nutrici√≥n √≥ptima.</p>
                        </div>
                        <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl p-6 text-white hover-lift">
                            <i class="fas fa-bed text-4xl mb-4 opacity-75"></i>
                            <h4 class="text-xl font-bold mb-3">Descanso</h4>
                            <p class="text-sm leading-relaxed opacity-90">Duerme 7-9 horas. El sue√±o es crucial para la recuperaci√≥n muscular.</p>
                        </div>
                        <div class="bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl p-6 text-white hover-lift">
                            <i class="fas fa-fire text-4xl mb-4 opacity-75"></i>
                            <h4 class="text-xl font-bold mb-3">Calentamiento</h4>
                            <p class="text-sm leading-relaxed opacity-90">5-10 minutos antes de entrenar previenen lesiones efectivamente.</p>
                        </div>
                        <div class="bg-gradient-to-br from-pink-500 to-pink-600 rounded-xl p-6 text-white hover-lift">
                            <i class="fas fa-stretch text-4xl mb-4 opacity-75"></i>
                            <h4 class="text-xl font-bold mb-3">Estiramiento</h4>
                            <p class="text-sm leading-relaxed opacity-90">Estira despu√©s de entrenar para mejorar flexibilidad y reducir dolor.</p>
                        </div>
                        <div class="bg-gradient-to-br from-red-500 to-red-600 rounded-xl p-6 text-white hover-lift">
                            <i class="fas fa-drumstick-bite text-4xl mb-4 opacity-75"></i>
                            <h4 class="text-xl font-bold mb-3">Pre-Entreno</h4>
                            <p class="text-sm leading-relaxed opacity-90">Come ligero 1-2 horas antes. Un pl√°tano o avena son ideales.</p>
                        </div>
                    </div>

                    <!-- Consejos Personalizados -->
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-star text-yellow-500 mr-3"></i>
                            Recomendaciones seg√∫n tu Objetivo
                        </h3>
                        <div id="consejosPersonalizados" class="prose max-w-none"></div>
                    </div>

                    <!-- Plan de Alimentaci√≥n -->
                    <div class="bg-white rounded-xl p-6 shadow-sm">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-utensils text-green-600 mr-3"></i>
                            Plan de Alimentaci√≥n Sugerido
                        </h3>
                        <div id="planAlimentacion" class="space-y-3"></div>
                    </div>
                </div>
            </div>

            <!-- PANTALLA RESUMEN -->
            <div id="resumen" class="screen">
                <div class="glass-effect rounded-2xl p-8 mb-6">
                    <div class="flex items-center mb-6">
                        <div class="bg-gradient-to-r from-indigo-600 to-purple-600 p-3 rounded-xl">
                            <i class="fas fa-award text-2xl text-white"></i>
                        </div>
                        <div class="ml-4">
                            <h2 class="text-3xl font-bold text-gray-800">Resumen de Progreso</h2>
                            <p class="text-gray-600">An√°lisis detallado de tu desempe√±o</p>
                        </div>
                    </div>

                    <div class="bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-6 mb-6 border-l-4 border-indigo-500">
                        <div class="flex items-center">
                            <i class="fas fa-calendar-alt text-3xl text-indigo-600 mr-4"></i>
                            <div>
                                <h4 class="font-bold text-gray-800">Per√≠odo de An√°lisis</h4>
                                <p id="periodoResumen" class="text-gray-600">√öltimos 30 d√≠as</p>
                            </div>
                        </div>
                    </div>

                    <!-- Logros -->
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-trophy text-yellow-500 mr-3"></i>
                            Logros Alcanzados
                        </h3>
                        <div id="logrosAlcanzados" class="space-y-2"></div>
                    </div>

                    <!-- Estad√≠sticas -->
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-chart-pie text-blue-600 mr-3"></i>
                            Estad√≠sticas Detalladas
                        </h3>
                        <div id="estadisticasDetalladas" class="space-y-3"></div>
                    </div>

                    <!-- Recomendaciones -->
                    <div class="bg-white rounded-xl p-6 shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fas fa-bullseye text-green-600 mr-3"></i>
                            Recomendaciones para Mejorar
                        </h3>
                        <div id="recomendacionesMejora" class="space-y-2"></div>
                    </div>

                    <!-- Acciones -->
                    <div class="flex flex-col md:flex-row gap-4">
                        <button onclick="exportarDatos()" 
                            class="bg-gradient-to-r from-green-600 to-emerald-600 px-8 py-4 rounded-xl text-white font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center space-x-2">
                            <i class="fas fa-download"></i>
                            <span>Exportar Datos</span>
                        </button>
                        <button onclick="resetearDatos()" 
                            class="bg-gradient-to-r from-red-600 to-rose-600 px-8 py-4 rounded-xl text-white font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center space-x-2">
                            <i class="fas fa-trash-alt"></i>
                            <span>Reiniciar Aplicaci√≥n</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales y almacenamiento
        let userData = {};
        let workoutHistory = [];
        let pesoHistory = [];
        let charts = {};

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            cargarDatos();
            actualizarTodo();
        });

        // Navegaci√≥n mejorada
        function showScreen(screenId) {
            // Actualizar pantallas
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            
            // Actualizar botones de navegaci√≥n
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('tab-active'));
            event.target.closest('.nav-btn').classList.add('tab-active');
            
            // Actualizar contenido espec√≠fico de cada pantalla
            if (screenId === 'progreso') {
                setTimeout(actualizarGraficos, 100);
            } else if (screenId === 'diario') {
                mostrarHistorial();
            } else if (screenId === 'consejos') {
                mostrarConsejosPersonalizados();
            } else if (screenId === 'resumen') {
                mostrarResumen();
            }
        }

        // Guardar datos del usuario
        function guardarDatos() {
            const nombre = document.getElementById('nombre').value;
            const edad = parseInt(document.getElementById('edad').value);
            const sexo = document.getElementById('sexo').value;
            const peso = parseFloat(document.getElementById('peso').value);
            const altura = parseFloat(document.getElementById('altura').value);
            const nivelActividad = document.getElementById('nivelActividad').value;
            const objetivo = document.getElementById('objetivo').value;

            if (!nombre || !edad || !sexo || !peso || !altura || !nivelActividad || !objetivo) {
                mostrarNotificacion('Por favor, completa todos los campos', 'error');
                return;
            }

            userData = {
                nombre,
                edad,
                sexo,
                peso,
                altura,
                nivelActividad,
                objetivo,
                fechaRegistro: new Date().toISOString()
            };

            // Calcular IMC
            const imc = calcularIMC(peso, altura);
            userData.imc = imc;

            // Guardar en localStorage
            localStorage.setItem('userData', JSON.stringify(userData));

            // Agregar peso al historial
            if (!pesoHistory.length || pesoHistory[pesoHistory.length - 1].peso !== peso) {
                pesoHistory.push({
                    fecha: new Date().toISOString(),
                    peso: peso
                });
                localStorage.setItem('pesoHistory', JSON.stringify(pesoHistory));
            }

            mostrarIMC(imc);
            mostrarNotificacion('¬°Datos guardados exitosamente!', 'success');
        }

        // Calcular IMC
        function calcularIMC(peso, altura) {
            const alturaMetros = altura / 100;
            return (peso / (alturaMetros * alturaMetros)).toFixed(1);
        }

        // Mostrar IMC
        function mostrarIMC(imc) {
            const imcResult = document.getElementById('imcResult');
            const imcValue = document.getElementById('imcValue');
            const imcCategory = document.getElementById('imcCategory');
            const imcInterpretation = document.getElementById('imcInterpretation');

            imcValue.textContent = imc;

            let categoria = '';
            let interpretacion = '';

            if (imc < 18.5) {
                categoria = 'Bajo Peso';
                interpretacion = 'üìä Tu IMC indica que est√°s por debajo del peso recomendado. Considera consultar a un profesional de salud para un plan personalizado.';
            } else if (imc < 25) {
                categoria = 'Normal';
                interpretacion = '‚ú® ¬°Excelente! Tu IMC est√° en el rango saludable. Mant√©n tu estilo de vida activo y equilibrado.';
            } else if (imc < 30) {
                categoria = 'Sobrepeso';
                interpretacion = 'üí™ Tu IMC indica sobrepeso. Con ejercicio regular y alimentaci√≥n balanceada puedes alcanzar un peso saludable.';
            } else {
                categoria = 'Obesidad';
                interpretacion = 'üè• Tu IMC indica obesidad. Es recomendable consultar a un profesional de salud para un plan personalizado y seguro.';
            }

            imcCategory.textContent = categoria;
            imcInterpretation.textContent = interpretacion;
            imcResult.classList.remove('hidden');
        }

        // Generar rutina personalizada
        function generarRutina() {
            if (!userData.objetivo) {
                mostrarNotificacion('Primero completa tus datos personales', 'error');
                return;
            }

            const diasSemana = parseInt(document.getElementById('diasSemana').value);
            const duracion = parseInt(document.getElementById('duracionSesion').value);
            const dificultad = document.getElementById('dificultadRutina').value;

            const ejercicios = obtenerEjerciciosPorObjetivo(userData.objetivo, dificultad);
            
            const container = document.getElementById('ejerciciosRecomendados');
            container.innerHTML = '';

            ejercicios.forEach((ejercicio, index) => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-xl p-6 shadow-sm hover-lift border-2 border-gray-100';
                card.style.animationDelay = `${index * 0.1}s`;
                card.innerHTML = `
                    <div class="flex items-start justify-between mb-3">
                        <h4 class="text-lg font-bold text-gray-800">${ejercicio.nombre}</h4>
                        <span class="px-3 py-1 rounded-full text-xs font-bold ${getDifficultyClass(dificultad)}">${dificultad.toUpperCase()}</span>
                    </div>
                    <div class="space-y-2 text-sm">
                        <p class="flex items-center text-gray-600">
                            <i class="fas fa-tag text-purple-600 mr-2"></i>
                            <strong>Tipo:</strong> <span class="ml-1">${ejercicio.tipo}</span>
                        </p>
                        <p class="text-gray-600">${ejercicio.descripcion}</p>
                        <p class="flex items-center text-gray-600">
                            <i class="fas fa-clock text-indigo-600 mr-2"></i>
                            <strong>Duraci√≥n:</strong> <span class="ml-1">${ejercicio.duracion}</span>
                        </p>
                        <div class="flex items-center justify-between pt-2 border-t border-gray-100">
                            <span class="flex items-center text-orange-600 font-semibold">
                                <i class="fas fa-fire mr-2"></i>
                                ${ejercicio.calorias} kcal
                            </span>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });

            document.getElementById('rutinaGenerada').classList.remove('hidden');
            mostrarNotificacion('¬°Rutina generada exitosamente!', 'success');
        }

        // Obtener clase de dificultad
        function getDifficultyClass(dificultad) {
            const classes = {
                facil: 'bg-green-100 text-green-700',
                medio: 'bg-yellow-100 text-yellow-700',
                dificil: 'bg-red-100 text-red-700'
            };
            return classes[dificultad] || classes.medio;
        }

        // Obtener ejercicios seg√∫n objetivo
        function obtenerEjerciciosPorObjetivo(objetivo, dificultad) {
            const ejerciciosBase = {
                perder: [
                    { nombre: 'Correr/Trotar', tipo: 'Cardio', descripcion: 'Excelente para quemar calor√≠as y mejorar resistencia cardiovascular', duracion: '30-45 minutos', calorias: 300 },
                    { nombre: 'Saltar la cuerda', tipo: 'Cardio', descripcion: 'Alta intensidad, quema calor√≠as r√°pidamente', duracion: '15-20 minutos', calorias: 250 },
                    { nombre: 'Burpees', tipo: 'HIIT', descripcion: 'Ejercicio de cuerpo completo de alta intensidad', duracion: '4 series de 10-15 reps', calorias: 200 },
                    { nombre: 'Ciclismo', tipo: 'Cardio', descripcion: 'Bajo impacto, ideal para quemar grasa', duracion: '45-60 minutos', calorias: 400 },
                    { nombre: 'Nataci√≥n', tipo: 'Cardio', descripcion: 'Trabajo completo del cuerpo sin impacto articular', duracion: '30-40 minutos', calorias: 350 }
                ],
                ganar: [
                    { nombre: 'Sentadillas', tipo: 'Fuerza', descripcion: 'Fundamental para desarrollo de piernas y gl√∫teos', duracion: '4 series de 8-12 reps', calorias: 150 },
                    { nombre: 'Press de banca', tipo: 'Fuerza', descripcion: 'Desarrolla pecho, hombros y tr√≠ceps', duracion: '4 series de 8-10 reps', calorias: 120 },
                    { nombre: 'Peso muerto', tipo: 'Fuerza', descripcion: 'Ejercicio compuesto para todo el cuerpo', duracion: '4 series de 6-8 reps', calorias: 180 },
                    { nombre: 'Dominadas', tipo: 'Fuerza', descripcion: 'Excelente para desarrollar espalda y b√≠ceps', duracion: '4 series al fallo', calorias: 140 },
                    { nombre: 'Press militar', tipo: 'Fuerza', descripcion: 'Desarrollo de hombros y core', duracion: '4 series de 8-10 reps', calorias: 130 }
                ],
                resistencia: [
                    { nombre: 'Carrera de larga distancia', tipo: 'Cardio', descripcion: 'Mejora resistencia cardiovascular', duracion: '45-60 minutos', calorias: 450 },
                    { nombre: 'Ciclismo de resistencia', tipo: 'Cardio', descripcion: 'Aumenta capacidad aer√≥bica', duracion: '60-90 minutos', calorias: 500 },
                    { nombre: 'Remo', tipo: 'Cardio', descripcion: 'Trabajo cardiovascular y muscular', duracion: '30-40 minutos', calorias: 380 },
                    { nombre: 'Entrenamiento en circuito', tipo: 'Mixto', descripcion: 'Combina fuerza y resistencia', duracion: '40-50 minutos', calorias: 400 },
                    { nombre: 'Senderismo', tipo: 'Cardio', descripcion: 'Resistencia con bajo impacto', duracion: '60-120 minutos', calorias: 350 }
                ],
                flexibilidad: [
                    { nombre: 'Yoga Hatha', tipo: 'Flexibilidad', descripcion: 'Mejora flexibilidad y equilibrio', duracion: '45-60 minutos', calorias: 180 },
                    { nombre: 'Estiramientos din√°micos', tipo: 'Flexibilidad', descripcion: 'Preparaci√≥n y recuperaci√≥n muscular', duracion: '20-30 minutos', calorias: 80 },
                    { nombre: 'Pilates', tipo: 'Flexibilidad', descripcion: 'Fortalecimiento del core y flexibilidad', duracion: '45-60 minutos', calorias: 200 },
                    { nombre: 'Tai Chi', tipo: 'Flexibilidad', descripcion: 'Movimiento fluido y balance', duracion: '30-45 minutos', calorias: 150 },
                    { nombre: 'Estiramientos est√°ticos', tipo: 'Flexibilidad', descripcion: 'Mejora rango de movimiento', duracion: '15-20 minutos', calorias: 60 }
                ],
                mantener: [
                    { nombre: 'Entrenamiento funcional', tipo: 'Mixto', descripcion: 'Mantiene condici√≥n f√≠sica general', duracion: '40-50 minutos', calorias: 300 },
                    { nombre: 'Caminata r√°pida', tipo: 'Cardio', descripcion: 'Mantiene salud cardiovascular', duracion: '30-40 minutos', calorias: 200 },
                    { nombre: 'Yoga Vinyasa', tipo: 'Flexibilidad', descripcion: 'Equilibrio entre fuerza y flexibilidad', duracion: '45-60 minutos', calorias: 250 },
                    { nombre: 'Nataci√≥n moderada', tipo: 'Cardio', descripcion: 'Ejercicio de bajo impacto', duracion: '30-45 minutos', calorias: 280 },
                    { nombre: 'Ejercicios con peso corporal', tipo: 'Fuerza', descripcion: 'Mantiene tono muscular', duracion: '30-40 minutos', calorias: 220 }
                ]
            };

            return ejerciciosBase[objetivo] || ejerciciosBase.mantener;
        }

        // Registrar entrenamiento
        function registrarEntrenamiento() {
            const tipo = document.getElementById('tipoEjercicio').value;
            const duracion = parseInt(document.getElementById('duracionEjercicio').value);
            const intensidad = document.getElementById('intensidad').value;
            const notas = document.getElementById('notasEjercicio').value;

            const calorias = calcularCalorias(tipo, duracion, intensidad, userData.peso || 70);

            const entrenamiento = {
                fecha: new Date().toISOString(),
                tipo,
                duracion,
                intensidad,
                calorias,
                notas
            };

            workoutHistory.push(entrenamiento);
            localStorage.setItem('workoutHistory', JSON.stringify(workoutHistory));

            document.getElementById('duracionEjercicio').value = 30;
            document.getElementById('notasEjercicio').value = '';

            mostrarNotificacion(`¬°Entrenamiento registrado! üî• ${calorias} calor√≠as quemadas`, 'success');
            mostrarHistorial();
            actualizarEstadisticas();
        }

        // Calcular calor√≠as
        function calcularCalorias(tipo, duracion, intensidad, peso) {
            const MET = {
                cardio: { baja: 3.5, media: 7, alta: 10 },
                fuerza: { baja: 3, media: 5, alta: 6 },
                flexibilidad: { baja: 2.5, media: 3, alta: 4 },
                hiit: { baja: 8, media: 10, alta: 12 }
            };

            const met = MET[tipo][intensidad];
            const calorias = Math.round((met * peso * duracion) / 60);
            return calorias;
        }

        // Mostrar historial mejorado
        function mostrarHistorial() {
            const container = document.getElementById('historialEntrenamientos');
            container.innerHTML = '';

            if (workoutHistory.length === 0) {
                container.innerHTML = '<p class="text-center text-gray-500 py-8">No hay entrenamientos registrados a√∫n. ¬°Comienza hoy!</p>';
                return;
            }

            const sorted = [...workoutHistory].reverse();
            sorted.forEach((workout, index) => {
                const fecha = new Date(workout.fecha);
                const div = document.createElement('div');
                div.className = 'bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-4 border-l-4 border-purple-500';
                div.innerHTML = `
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="text-xs text-gray-500 mb-1">${fecha.toLocaleDateString('es-ES', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>
                            <div class="font-bold text-gray-800 text-lg">${workout.tipo.toUpperCase()}</div>
                            <div class="text-sm text-gray-600 mt-1">
                                <span class="inline-flex items-center mr-4">
                                    <i class="fas fa-clock text-purple-600 mr-1"></i> ${workout.duracion} min
                                </span>
                                <span class="inline-flex items-center mr-4">
                                    <i class="fas fa-fire text-orange-600 mr-1"></i> ${workout.calorias} kcal
                                </span>
                                <span class="inline-flex items-center">
                                    <i class="fas fa-bolt text-yellow-600 mr-1"></i> ${workout.intensidad}
                                </span>
                            </div>
                            ${workout.notas ? '<div class="mt-2 text-sm text-gray-600 italic">"' + workout.notas + '"</div>' : ''}
                        </div>
                        <div class="ml-4">
                            ${getTipoIcon(workout.tipo)}
                        </div>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // Obtener icono seg√∫n tipo
        function getTipoIcon(tipo) {
            const icons = {
                cardio: '<i class="fas fa-running text-3xl text-blue-600"></i>',
                fuerza: '<i class="fas fa-dumbbell text-3xl text-purple-600"></i>',
                flexibilidad: '<i class="fas fa-spa text-3xl text-green-600"></i>',
                hiit: '<i class="fas fa-fire text-3xl text-red-600"></i>'
            };
            return icons[tipo] || icons.cardio;
        }

        // Actualizar estad√≠sticas
        function actualizarEstadisticas() {
            const totalEntrenamientos = workoutHistory.length;
            const totalCalorias = workoutHistory.reduce((sum, w) => sum + w.calorias, 0);
            const totalTiempo = workoutHistory.reduce((sum, w) => sum + w.duracion, 0);

            document.getElementById('totalEntrenamientos').textContent = totalEntrenamientos;
            document.getElementById('totalCalorias').textContent = totalCalorias.toLocaleString();
            document.getElementById('totalTiempo').textContent = totalTiempo;
            
            const racha = calcularRacha();
            document.getElementById('rachaActual').textContent = racha;
        }

        // Calcular racha
        function calcularRacha() {
            if (workoutHistory.length === 0) return 0;

            const fechas = workoutHistory.map(w => {
                const d = new Date(w.fecha);
                return new Date(d.getFullYear(), d.getMonth(), d.getDate()).getTime();
            });

            const uniqueFechas = [...new Set(fechas)].sort((a, b) => b - a);
            
            let racha = 0;
            const hoy = new Date();
            hoy.setHours(0, 0, 0, 0);
            let fechaActual = hoy.getTime();

            for (let fecha of uniqueFechas) {
                if (fecha === fechaActual || fecha === fechaActual - 86400000) {
                    racha++;
                    fechaActual = fecha - 86400000;
                } else {
                    break;
                }
            }

            return racha;
        }

        // Actualizar gr√°ficos
        function actualizarGraficos() {
            actualizarEstadisticas();
            crearGraficoPeso();
            crearGraficoCalorias();
            crearGraficoEjercicios();
        }

        // Gr√°fico de peso
        function crearGraficoPeso() {
            const ctx = document.getElementById('pesoChart');
            
            if (charts.peso) {
                charts.peso.destroy();
            }

            const labels = pesoHistory.map(p => new Date(p.fecha).toLocaleDateString('es-ES'));
            const data = pesoHistory.map(p => p.peso);

            charts.peso = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Peso (kg)',
                        data: data,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false
                        }
                    }
                }
            });
        }

        // Gr√°fico de calor√≠as
        function crearGraficoCalorias() {
            const ctx = document.getElementById('caloriasChart');
            
            if (charts.calorias) {
                charts.calorias.destroy();
            }

            // Agrupar por semana
            const semanales = agruparPorSemana(workoutHistory);

            charts.calorias = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: semanales.labels,
                    datasets: [{
                        label: 'Calor√≠as Quemadas',
                        data: semanales.calorias,
                        backgroundColor: '#764ba2',
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true
                        }
                    }
                }
            });
        }

        // Gr√°fico de ejercicios
        function crearGraficoEjercicios() {
            const ctx = document.getElementById('ejerciciosChart');
            
            if (charts.ejercicios) {
                charts.ejercicios.destroy();
            }

            const tipos = {};
            workoutHistory.forEach(w => {
                tipos[w.tipo] = (tipos[w.tipo] || 0) + 1;
            });

            charts.ejercicios = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(tipos).map(t => t.toUpperCase()),
                    datasets: [{
                        data: Object.values(tipos),
                        backgroundColor: [
                            '#667eea',
                            '#764ba2',
                            '#f093fb',
                            '#f5576c'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Agrupar por semana
        function agruparPorSemana(workouts) {
            const semanas = {};
            
            workouts.forEach(w => {
                const fecha = new Date(w.fecha);
                const semana = obtenerSemana(fecha);
                
                if (!semanas[semana]) {
                    semanas[semana] = { calorias: 0, count: 0 };
                }
                
                semanas[semana].calorias += w.calorias;
                semanas[semana].count++;
            });

            return {
                labels: Object.keys(semanas),
                calorias: Object.values(semanas).map(s => s.calorias)
            };
        }

        // Obtener n√∫mero de semana
        function obtenerSemana(fecha) {
            const inicio = new Date(fecha.getFullYear(), 0, 1);
            const dias = Math.floor((fecha - inicio) / (24 * 60 * 60 * 1000));
            return `Semana ${Math.ceil((dias + inicio.getDay() + 1) / 7)}`;
        }

        // Mostrar consejos personalizados
        function mostrarConsejosPersonalizados() {
            const container = document.getElementById('consejosPersonalizados');
            const containerPlan = document.getElementById('planAlimentacion');

            if (!userData.objetivo) {
                container.innerHTML = '<p>Completa tus datos personales primero para recibir consejos personalizados.</p>';
                return;
            }

            const consejos = {
                perder: {
                    titulo: 'Consejos para P√©rdida de Peso',
                    tips: [
                        'Mant√©n un d√©ficit cal√≥rico de 300-500 calor√≠as diarias',
                        'Prioriza prote√≠nas magras en cada comida (pollo, pescado, legumbres)',
                        'Evita alimentos ultraprocesados y az√∫cares a√±adidos',
                        'Come cada 3-4 horas para mantener el metabolismo activo',
                        'Bebe agua antes de cada comida para aumentar la saciedad'
                    ],
                    plan: [
                        '<strong>Desayuno:</strong> Avena con frutas y nueces',
                        '<strong>Media ma√±ana:</strong> Yogur griego con ar√°ndanos',
                        '<strong>Almuerzo:</strong> Pechuga de pollo con ensalada y quinoa',
                        '<strong>Merienda:</strong> Frutas con mantequilla de almendras',
                        '<strong>Cena:</strong> Pescado al horno con vegetales'
                    ]
                },
                ganar: {
                    titulo: 'Consejos para Ganancia Muscular',
                    tips: [
                        'Consume 1.6-2.2g de prote√≠na por kg de peso corporal',
                        'Mant√©n un super√°vit cal√≥rico de 300-500 calor√≠as diarias',
                        'Come carbohidratos complejos antes y despu√©s del entrenamiento',
                        'No temas a las grasas saludables (aguacate, frutos secos, aceite de oliva)',
                        'Come cada 2-3 horas para mantener s√≠ntesis proteica'
                    ],
                    plan: [
                        '<strong>Desayuno:</strong> Huevos, avena y pl√°tano',
                        '<strong>Media ma√±ana:</strong> Batido de prote√≠na con frutos secos',
                        '<strong>Almuerzo:</strong> Arroz integral, carne magra y verduras',
                        '<strong>Pre-entreno:</strong> Pl√°tano y mantequilla de man√≠',
                        '<strong>Post-entreno:</strong> Batido de prote√≠na con carbohidratos',
                        '<strong>Cena:</strong> Salm√≥n, batata y br√≥coli'
                    ]
                },
                resistencia: {
                    titulo: 'Consejos para Aumentar Resistencia',
                    tips: [
                        'Prioriza carbohidratos complejos (pasta integral, arroz, avena)',
                        'Mant√©n una hidrataci√≥n constante, especialmente durante entrenamientos largos',
                        'Consume alimentos ricos en hierro para mejorar transporte de ox√≠geno',
                        'Incluye grasas saludables para energ√≠a sostenida',
                        'Come carbohidratos 2-3 horas antes de entrenamientos largos'
                    ],
                    plan: [
                        '<strong>Desayuno:</strong> Tostadas integrales con aguacate y huevo',
                        '<strong>Media ma√±ana:</strong> Pl√°tano y almendras',
                        '<strong>Almuerzo:</strong> Pasta integral con pollo y vegetales',
                        '<strong>Merienda:</strong> Batido de frutas',
                        '<strong>Cena:</strong> Arroz con legumbres y ensalada'
                    ]
                },
                flexibilidad: {
                    titulo: 'Consejos para Mejorar Flexibilidad',
                    tips: [
                        'Mant√©n una dieta antiinflamatoria rica en omega-3',
                        'Consume alimentos ricos en magnesio (espinacas, pl√°tanos, almendras)',
                        'Bebe suficiente agua para mantener tejidos hidratados',
                        'Incluye col√°geno y vitamina C para salud articular',
                        'Evita alimentos inflamatorios (az√∫cares, grasas trans)'
                    ],
                    plan: [
                        '<strong>Desayuno:</strong> Smoothie con espinacas, pl√°tano y linaza',
                        '<strong>Media ma√±ana:</strong> Nueces y frutas',
                        '<strong>Almuerzo:</strong> Salm√≥n con quinoa y vegetales verdes',
                        '<strong>Merienda:</strong> Yogur con semillas de ch√≠a',
                        '<strong>Cena:</strong> Ensalada con aguacate y pollo'
                    ]
                },
                mantener: {
                    titulo: 'Consejos para Mantener Condici√≥n F√≠sica',
                    tips: [
                        'Mant√©n una dieta balanceada con todos los macronutrientes',
                        'Come variedad de colores en frutas y verduras',
                        'Equilibra prote√≠nas, carbohidratos y grasas en cada comida',
                        'Mant√©n horarios regulares de comida',
                        'Disfruta con moderaci√≥n, sin restricciones extremas'
                    ],
                    plan: [
                        '<strong>Desayuno:</strong> Tostada integral con aguacate y huevo',
                        '<strong>Media ma√±ana:</strong> Frutas con yogur',
                        '<strong>Almuerzo:</strong> Prote√≠na + carbohidrato + vegetales',
                        '<strong>Merienda:</strong> Frutos secos y fruta',
                        '<strong>Cena:</strong> Prote√≠na ligera con ensalada'
                    ]
                }
            };

            const consejo = consejos[userData.objetivo];
            
            container.innerHTML = `
                <h4>${consejo.titulo}</h4>
                <ul>
                    ${consejo.tips.map(tip => `<li>${tip}</li>`).join('')}
                </ul>
            `;

            containerPlan.innerHTML = `
                <p><strong>Plan diario sugerido:</strong></p>
                <ul>
                    ${consejo.plan.map(comida => `<li>${comida}</li>`).join('')}
                </ul>
            `;
        }

        // Mostrar resumen
        function mostrarResumen() {
            const logrosContainer = document.getElementById('logrosAlcanzados');
            const estadisticasContainer = document.getElementById('estadisticasDetalladas');
            const recomendacionesContainer = document.getElementById('recomendacionesMejora');

            // Logros
            const logros = [];
            if (workoutHistory.length >= 5) logros.push('üéâ Has completado m√°s de 5 entrenamientos');
            if (workoutHistory.length >= 10) logros.push('üî• Has completado m√°s de 10 entrenamientos');
            if (workoutHistory.length >= 20) logros.push('‚≠ê Has completado m√°s de 20 entrenamientos');
            
            const totalCalorias = workoutHistory.reduce((sum, w) => sum + w.calorias, 0);
            if (totalCalorias >= 1000) logros.push('üí™ Has quemado m√°s de 1,000 calor√≠as');
            if (totalCalorias >= 5000) logros.push('üèÜ Has quemado m√°s de 5,000 calor√≠as');
            
            const racha = calcularRacha();
            if (racha >= 3) logros.push(`üî• Racha de ${racha} d√≠as consecutivos`);
            if (racha >= 7) logros.push('üëë ¬°Una semana completa de ejercicio!');

            logrosContainer.innerHTML = logros.length > 0 
                ? '<ul>' + logros.map(l => `<li style="margin: 10px 0; font-size: 1.1em;">${l}</li>`).join('') + '</ul>'
                : '<p>Contin√∫a entrenando para desbloquear logros.</p>';

            // Estad√≠sticas
            const tiposMasComunes = {};
            workoutHistory.forEach(w => {
                tiposMasComunes[w.tipo] = (tiposMasComunes[w.tipo] || 0) + 1;
            });
            const tipoFavorito = Object.keys(tiposMasComunes).reduce((a, b) => 
                tiposMasComunes[a] > tiposMasComunes[b] ? a : b, 'ninguno'
            );

            const promedioSemanal = (workoutHistory.length / ((Date.now() - new Date(userData.fechaRegistro || Date.now()).getTime()) / (7 * 24 * 60 * 60 * 1000))).toFixed(1);

            estadisticasContainer.innerHTML = `
                <ul>
                    <li><strong>Total de entrenamientos:</strong> ${workoutHistory.length}</li>
                    <li><strong>Tipo de ejercicio favorito:</strong> ${tipoFavorito.toUpperCase()}</li>
                    <li><strong>Promedio semanal:</strong> ${promedioSemanal} entrenamientos/semana</li>
                    <li><strong>Total calor√≠as quemadas:</strong> ${totalCalorias.toLocaleString()} kcal</li>
                    <li><strong>Racha actual:</strong> ${racha} d√≠as</li>
                </ul>
            `;

            // Recomendaciones
            const recomendaciones = [];
            if (workoutHistory.length < 3) {
                recomendaciones.push('Intenta entrenar al menos 3 veces por semana para mejores resultados');
            }
            if (racha === 0) {
                recomendaciones.push('¬°Comienza una nueva racha hoy! La consistencia es clave');
            }
            const ultimoEntrenamiento = workoutHistory[workoutHistory.length - 1];
            if (ultimoEntrenamiento) {
                const diasDesde = Math.floor((Date.now() - new Date(ultimoEntrenamiento.fecha).getTime()) / (24 * 60 * 60 * 1000));
                if (diasDesde > 3) {
                    recomendaciones.push('Han pasado varios d√≠as desde tu √∫ltimo entrenamiento. ¬°Es hora de volver!');
                }
            }

            const diversidad = Object.keys(tiposMasComunes).length;
            if (diversidad < 2) {
                recomendaciones.push('Intenta variar los tipos de ejercicio para un entrenamiento m√°s completo');
            }

            recomendacionesContainer.innerHTML = recomendaciones.length > 0
                ? '<ul>' + recomendaciones.map(r => `<li style="margin: 10px 0;">${r}</li>`).join('') + '</ul>'
                : '<p>¬°Excelente trabajo! Contin√∫a as√≠.</p>';
        }

        // Exportar datos
        function exportarDatos() {
            const datos = {
                usuario: userData,
                entrenamientos: workoutHistory,
                historialPeso: pesoHistory,
                fecha_exportacion: new Date().toISOString()
            };

            const dataStr = JSON.stringify(datos, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `simulador_salud_${Date.now()}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            alert('Datos exportados exitosamente');
        }

        // Resetear datos
        function resetearDatos() {
            if (confirm('¬øEst√°s seguro de que quieres borrar todos los datos? Esta acci√≥n no se puede deshacer.')) {
                localStorage.clear();
                userData = {};
                workoutHistory = [];
                pesoHistory = [];
                alert('Datos eliminados. Recarga la p√°gina para comenzar de nuevo.');
                location.reload();
            }
        }

        // Cargar datos
        function cargarDatos() {
            const savedUserData = localStorage.getItem('userData');
            if (savedUserData) {
                userData = JSON.parse(savedUserData);
                
                // Rellenar formulario
                document.getElementById('nombre').value = userData.nombre || '';
                document.getElementById('edad').value = userData.edad || '';
                document.getElementById('sexo').value = userData.sexo || '';
                document.getElementById('peso').value = userData.peso || '';
                document.getElementById('altura').value = userData.altura || '';
                document.getElementById('nivelActividad').value = userData.nivelActividad || '';
                document.getElementById('objetivo').value = userData.objetivo || '';
                
                if (userData.imc) {
                    mostrarIMC(userData.imc);
                }
            }

            const savedWorkouts = localStorage.getItem('workoutHistory');
            if (savedWorkouts) {
                workoutHistory = JSON.parse(savedWorkouts);
            }

            const savedPeso = localStorage.getItem('pesoHistory');
            if (savedPeso) {
                pesoHistory = JSON.parse(savedPeso);
            }
        }


        // Actualizar gr√°ficos
        function actualizarGraficos() {
            actualizarEstadisticas();
            crearGraficoPeso();
            crearGraficoCalorias();
            crearGraficoEjercicios();
        }

        // Gr√°fico de peso
        function crearGraficoPeso() {
            const ctx = document.getElementById('pesoChart');
            
            if (charts.peso) {
                charts.peso.destroy();
            }

            const labels = pesoHistory.map(p => new Date(p.fecha).toLocaleDateString('es-ES'));
            const data = pesoHistory.map(p => p.peso);

            charts.peso = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Peso (kg)',
                        data: data,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 3,
                        pointBackgroundColor: '#667eea',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            labels: {
                                font: {
                                    size: 14,
                                    family: 'Inter'
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: {
                                color: 'rgba(0,0,0,0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // Gr√°fico de calor√≠as
        function crearGraficoCalorias() {
            const ctx = document.getElementById('caloriasChart');
            
            if (charts.calorias) {
                charts.calorias.destroy();
            }

            const semanales = agruparPorSemana(workoutHistory);

            charts.calorias = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: semanales.labels,
                    datasets: [{
                        label: 'Calor√≠as Quemadas',
                        data: semanales.calorias,
                        backgroundColor: '#764ba2',
                        borderRadius: 8,
                        barThickness: 40
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            labels: {
                                font: {
                                    size: 14,
                                    family: 'Inter'
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            grid: {
                                color: 'rgba(0,0,0,0.05)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // Gr√°fico de ejercicios
        function crearGraficoEjercicios() {
            const ctx = document.getElementById('ejerciciosChart');
            
            if (charts.ejercicios) {
                charts.ejercicios.destroy();
            }

            const tipos = {};
            workoutHistory.forEach(w => {
                tipos[w.tipo] = (tipos[w.tipo] || 0) + 1;
            });

            charts.ejercicios = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(tipos).map(t => t.charAt(0).toUpperCase() + t.slice(1)),
                    datasets: [{
                        data: Object.values(tipos),
                        backgroundColor: [
                            '#667eea',
                            '#764ba2',
                            '#f093fb',
                            '#f5576c'
                        ],
                        borderWidth: 3,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 14,
                                    family: 'Inter'
                                },
                                padding: 20
                            }
                        }
                    }
                }
            });
        }

        // Agrupar por semana
        function agruparPorSemana(workouts) {
            const semanas = {};
            
            workouts.forEach(w => {
                const fecha = new Date(w.fecha);
                const semana = obtenerSemana(fecha);
                
                if (!semanas[semana]) {
                    semanas[semana] = { calorias: 0, count: 0 };
                }
                
                semanas[semana].calorias += w.calorias;
                semanas[semana].count++;
            });

            return {
                labels: Object.keys(semanas),
                calorias: Object.values(semanas).map(s => s.calorias)
            };
        }

        // Obtener n√∫mero de semana
        function obtenerSemana(fecha) {
            const inicio = new Date(fecha.getFullYear(), 0, 1);
            const dias = Math.floor((fecha - inicio) / (24 * 60 * 60 * 1000));
            return `Sem ${Math.ceil((dias + inicio.getDay() + 1) / 7)}`;
        }

        // Mostrar consejos personalizados
        function mostrarConsejosPersonalizados() {
            const container = document.getElementById('consejosPersonalizados');
            const containerPlan = document.getElementById('planAlimentacion');

            if (!userData.objetivo) {
                container.innerHTML = '<p class="text-gray-600">Completa tus datos personales primero para recibir consejos personalizados.</p>';
                return;
            }

            const consejos = {
                perder: {
                    titulo: 'Consejos para P√©rdida de Peso',
                    tips: [
                        'Mant√©n un d√©ficit cal√≥rico de 300-500 calor√≠as diarias',
                        'Prioriza prote√≠nas magras en cada comida',
                        'Evita alimentos ultraprocesados y az√∫cares a√±adidos',
                        'Come cada 3-4 horas para mantener el metabolismo activo',
                        'Bebe agua antes de cada comida'
                    ],
                    plan: [
                        '<strong class="text-purple-600">Desayuno:</strong> Avena con frutas y nueces',
                        '<strong class="text-purple-600">Media ma√±ana:</strong> Yogur griego con ar√°ndanos',
                        '<strong class="text-purple-600">Almuerzo:</strong> Pechuga de pollo con ensalada y quinoa',
                        '<strong class="text-purple-600">Merienda:</strong> Frutas con mantequilla de almendras',
                        '<strong class="text-purple-600">Cena:</strong> Pescado al horno con vegetales'
                    ]
                },
                ganar: {
                    titulo: 'Consejos para Ganancia Muscular',
                    tips: [
                        'Consume 1.6-2.2g de prote√≠na por kg de peso corporal',
                        'Mant√©n un super√°vit cal√≥rico de 300-500 calor√≠as diarias',
                        'Come carbohidratos complejos antes y despu√©s del entrenamiento',
                        'No temas a las grasas saludables',
                        'Come cada 2-3 horas para mantener s√≠ntesis proteica'
                    ],
                    plan: [
                        '<strong class="text-purple-600">Desayuno:</strong> Huevos, avena y pl√°tano',
                        '<strong class="text-purple-600">Media ma√±ana:</strong> Batido de prote√≠na con frutos secos',
                        '<strong class="text-purple-600">Almuerzo:</strong> Arroz integral, carne magra y verduras',
                        '<strong class="text-purple-600">Pre-entreno:</strong> Pl√°tano y mantequilla de man√≠',
                        '<strong class="text-purple-600">Post-entreno:</strong> Batido de prote√≠na con carbohidratos',
                        '<strong class="text-purple-600">Cena:</strong> Salm√≥n, batata y br√≥coli'
                    ]
                },
                resistencia: {
                    titulo: 'Consejos para Aumentar Resistencia',
                    tips: [
                        'Prioriza carbohidratos complejos',
                        'Mant√©n una hidrataci√≥n constante',
                        'Consume alimentos ricos en hierro',
                        'Incluye grasas saludables',
                        'Come carbohidratos 2-3 horas antes de entrenamientos largos'
                    ],
                    plan: [
                        '<strong class="text-purple-600">Desayuno:</strong> Tostadas integrales con aguacate',
                        '<strong class="text-purple-600">Media ma√±ana:</strong> Pl√°tano y almendras',
                        '<strong class="text-purple-600">Almuerzo:</strong> Pasta integral con pollo',
                        '<strong class="text-purple-600">Merienda:</strong> Batido de frutas',
                        '<strong class="text-purple-600">Cena:</strong> Arroz con legumbres'
                    ]
                },
                flexibilidad: {
                    titulo: 'Consejos para Mejorar Flexibilidad',
                    tips: [
                        'Mant√©n una dieta antiinflamatoria rica en omega-3',
                        'Consume alimentos ricos en magnesio',
                        'Bebe suficiente agua',
                        'Incluye col√°geno y vitamina C',
                        'Evita alimentos inflamatorios'
                    ],
                    plan: [
                        '<strong class="text-purple-600">Desayuno:</strong> Smoothie con espinacas y pl√°tano',
                        '<strong class="text-purple-600">Media ma√±ana:</strong> Nueces y frutas',
                        '<strong class="text-purple-600">Almuerzo:</strong> Salm√≥n con quinoa',
                        '<strong class="text-purple-600">Merienda:</strong> Yogur con ch√≠a',
                        '<strong class="text-purple-600">Cena:</strong> Ensalada con aguacate'
                    ]
                },
                mantener: {
                    titulo: 'Consejos para Mantener Condici√≥n F√≠sica',
                    tips: [
                        'Mant√©n una dieta balanceada',
                        'Come variedad de colores en frutas y verduras',
                        'Equilibra prote√≠nas, carbohidratos y grasas',
                        'Mant√©n horarios regulares de comida',
                        'Disfruta con moderaci√≥n'
                    ],
                    plan: [
                        '<strong class="text-purple-600">Desayuno:</strong> Tostada integral con aguacate',
                        '<strong class="text-purple-600">Media ma√±ana:</strong> Frutas con yogur',
                        '<strong class="text-purple-600">Almuerzo:</strong> Prote√≠na + carbohidrato + vegetales',
                        '<strong class="text-purple-600">Merienda:</strong> Frutos secos',
                        '<strong class="text-purple-600">Cena:</strong> Prote√≠na ligera con ensalada'
                    ]
                }
            };

            const consejo = consejos[userData.objetivo];
            
            container.innerHTML = `
                <h4 class="text-lg font-bold text-gray-800 mb-3">${consejo.titulo}</h4>
                <ul class="space-y-2">
                    ${consejo.tips.map(tip => `<li class="flex items-start"><i class="fas fa-check-circle text-green-600 mr-2 mt-1"></i><span class="text-gray-700">${tip}</span></li>`).join('')}
                </ul>
            `;

            containerPlan.innerHTML = consejo.plan.map(comida => `
                <div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg p-4">${comida}</div>
            `).join('');
        }

        // Mostrar resumen
        function mostrarResumen() {
            const logrosContainer = document.getElementById('logrosAlcanzados');
            const estadisticasContainer = document.getElementById('estadisticasDetalladas');
            const recomendacionesContainer = document.getElementById('recomendacionesMejora');

            // Logros
            const logros = [];
            if (workoutHistory.length >= 5) logros.push({ icon: 'fa-medal', text: 'Has completado m√°s de 5 entrenamientos', color: 'text-green-600' });
            if (workoutHistory.length >= 10) logros.push({ icon: 'fa-fire', text: 'Has completado m√°s de 10 entrenamientos', color: 'text-orange-600' });
            if (workoutHistory.length >= 20) logros.push({ icon: 'fa-star', text: 'Has completado m√°s de 20 entrenamientos', color: 'text-yellow-600' });
            
            const totalCalorias = workoutHistory.reduce((sum, w) => sum + w.calorias, 0);
            if (totalCalorias >= 1000) logros.push({ icon: 'fa-bolt', text: 'Has quemado m√°s de 1,000 calor√≠as', color: 'text-purple-600' });
            if (totalCalorias >= 5000) logros.push({ icon: 'fa-trophy', text: 'Has quemado m√°s de 5,000 calor√≠as', color: 'text-indigo-600' });
            
            const racha = calcularRacha();
            if (racha >= 3) logros.push({ icon: 'fa-calendar-check', text: `Racha de ${racha} d√≠as consecutivos`, color: 'text-blue-600' });
            if (racha >= 7) logros.push({ icon: 'fa-crown', text: '¬°Una semana completa de ejercicio!', color: 'text-pink-600' });

            logrosContainer.innerHTML = logros.length > 0 
                ? logros.map(l => `
                    <div class="flex items-center bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg p-4">
                        <i class="fas ${l.icon} ${l.color} text-2xl mr-4"></i>
                        <span class="text-gray-800 font-medium">${l.text}</span>
                    </div>
                `).join('')
                : '<p class="text-gray-600">Contin√∫a entrenando para desbloquear logros.</p>';

            // Estad√≠sticas
            const tiposMasComunes = {};
            workoutHistory.forEach(w => {
                tiposMasComunes[w.tipo] = (tiposMasComunes[w.tipo] || 0) + 1;
            });
            const tipoFavorito = Object.keys(tiposMasComunes).reduce((a, b) => 
                tiposMasComunes[a] > tiposMasComunes[b] ? a : b, 'ninguno'
            );

            const promedioSemanal = (workoutHistory.length / ((Date.now() - new Date(userData.fechaRegistro || Date.now()).getTime()) / (7 * 24 * 60 * 60 * 1000))).toFixed(1);

            const stats = [
                { icon: 'fa-dumbbell', label: 'Total entrenamientos', value: workoutHistory.length },
                { icon: 'fa-heart', label: 'Ejercicio favorito', value: tipoFavorito.toUpperCase() },
                { icon: 'fa-chart-line', label: 'Promedio semanal', value: `${promedioSemanal} entrenamientos` },
                { icon: 'fa-fire', label: 'Calor√≠as totales', value: `${totalCalorias.toLocaleString()} kcal` },
                { icon: 'fa-bolt', label: 'Racha actual', value: `${racha} d√≠as` }
            ];

            estadisticasContainer.innerHTML = stats.map(s => `
                <div class="flex items-center justify-between bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg p-4">
                    <div class="flex items-center">
                        <i class="fas ${s.icon} text-purple-600 text-xl mr-4"></i>
                        <span class="text-gray-700 font-medium">${s.label}</span>
                    </div>
                    <span class="text-gray-900 font-bold">${s.value}</span>
                </div>
            `).join('');

            // Recomendaciones
            const recomendaciones = [];
            if (workoutHistory.length < 3) {
                recomendaciones.push({ icon: 'fa-info-circle', text: 'Intenta entrenar al menos 3 veces por semana' });
            }
            if (racha === 0) {
                recomendaciones.push({ icon: 'fa-fire', text: '¬°Comienza una nueva racha hoy!' });
            }
            const ultimoEntrenamiento = workoutHistory[workoutHistory.length - 1];
            if (ultimoEntrenamiento) {
                const diasDesde = Math.floor((Date.now() - new Date(ultimoEntrenamiento.fecha).getTime()) / (24 * 60 * 60 * 1000));
                if (diasDesde > 3) {
                    recomendaciones.push({ icon: 'fa-exclamation-triangle', text: 'Han pasado varios d√≠as sin entrenar' });
                }
            }

            const diversidad = Object.keys(tiposMasComunes).length;
            if (diversidad < 2) {
                recomendaciones.push({ icon: 'fa-random', text: 'Var√≠a los tipos de ejercicio' });
            }

            recomendacionesContainer.innerHTML = recomendaciones.length > 0
                ? recomendaciones.map(r => `
                    <div class="flex items-center bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg p-4">
                        <i class="fas ${r.icon} text-orange-600 text-xl mr-4"></i>
                        <span class="text-gray-800">${r.text}</span>
                    </div>
                `).join('')
                : '<p class="text-gray-600">¬°Excelente trabajo! Contin√∫a as√≠.</p>';
        }

        // Exportar datos
        function exportarDatos() {
            const datos = {
                usuario: userData,
                entrenamientos: workoutHistory,
                historialPeso: pesoHistory,
                fecha_exportacion: new Date().toISOString()
            };

            const dataStr = JSON.stringify(datos, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `fitlife_pro_${Date.now()}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            mostrarNotificacion('Datos exportados exitosamente', 'success');
        }

        // Resetear datos
        function resetearDatos() {
            if (confirm('¬øEst√°s seguro de que quieres borrar todos los datos? Esta acci√≥n no se puede deshacer.')) {
                localStorage.clear();
                userData = {};
                workoutHistory = [];
                pesoHistory = [];
                mostrarNotificacion('Datos eliminados', 'info');
                setTimeout(() => location.reload(), 1500);
            }
        }

        // Cargar datos
        function cargarDatos() {
            const savedUserData = localStorage.getItem('userData');
            if (savedUserData) {
                userData = JSON.parse(savedUserData);
                
                document.getElementById('nombre').value = userData.nombre || '';
                document.getElementById('edad').value = userData.edad || '';
                document.getElementById('sexo').value = userData.sexo || '';
                document.getElementById('peso').value = userData.peso || '';
                document.getElementById('altura').value = userData.altura || '';
                document.getElementById('nivelActividad').value = userData.nivelActividad || '';
                document.getElementById('objetivo').value = userData.objetivo || '';
                
                if (userData.imc) {
                    mostrarIMC(userData.imc);
                }
            }

            const savedWorkouts = localStorage.getItem('workoutHistory');
            if (savedWorkouts) {
                workoutHistory = JSON.parse(savedWorkouts);
            }

            const savedPeso = localStorage.getItem('pesoHistory');
            if (savedPeso) {
                pesoHistory = JSON.parse(savedPeso);
            }
        }

        // Actualizar todo
        function actualizarTodo() {
            actualizarEstadisticas();
            mostrarHistorial();
        }

        // Sistema de notificaciones
        function mostrarNotificacion(mensaje, tipo = 'info') {
            const notif = document.createElement('div');
            const colors = {
                success: 'bg-green-500',
                error: 'bg-red-500',
                info: 'bg-blue-500'
            };
            
            notif.className = `fixed top-4 right-4 ${colors[tipo]} text-white px-6 py-4 rounded-xl shadow-lg z-50 animate-fade-in`;
            notif.textContent = mensaje;
            document.body.appendChild(notif);
            
            setTimeout(() => {
                notif.style.opacity = '0';
                setTimeout(() => notif.remove(), 300);
            }, 3000);
        }
    </script>
</body>
</html>